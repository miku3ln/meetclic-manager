var jscolor = {
    dir: "",
    bindClass: "color",
    binding: !0,
    preloading: !0,
    install: function () {
        jscolor.addEvent(window, "load", jscolor.init)
    },
    init: function () {
        jscolor.binding && jscolor.bind(), jscolor.preloading && jscolor.preload()
    },
    getDir: function () {
        if (!jscolor.dir) {
            var e = jscolor.detectDir();
            jscolor.dir = !1 !== e ? e : $resourceRoot + '/libs/blitz-gmap-editor/jscolor/';
        } else {//change values
            jscolor.dir = $resourceRoot + '/libs/blitz-gmap-editor/jscolor/';
        }
        return jscolor.dir
    },
    detectDir: function () {
        for (var e = location.href, t = document.getElementsByTagName("base"), o = 0; o < t.length; o += 1) t[o].href && (e = t[o].href);
        for (t = document.getElementsByTagName("script"), o = 0; o < t.length; o += 1) if (t[o].src && /(^|\/)jscolor\.js([?#].*)?$/i.test(t[o].src)) {
            var n = new jscolor.URI(t[o].src).toAbsolute(e);
            return n.path = n.path.replace(/[^\/]+$/, ""), n.query = null, n.fragment = null, n.toString()
        }
        return !1
    },
    bind: function () {
        for (var matchClass = new RegExp("(^|\\s)(" + jscolor.bindClass + ")\\s*(\\{[^}]*\\})?", "i"), e = document.getElementsByTagName("input"), i = 0; i < e.length; i += 1) {
            var m;
            if (!e[i].color && e[i].className && (m = e[i].className.match(matchClass))) {
                var prop = {};
                if (m[3]) try {
                    eval("prop=" + m[3])
                } catch (e) {
                }
                e[i].color = new jscolor.color(e[i], prop)
            }
        }
    },
    preload: function () {
        for (var e in jscolor.imgRequire) jscolor.imgRequire.hasOwnProperty(e) && jscolor.loadImage(e)
    },
    images: {pad: [181, 101], sld: [16, 101], cross: [15, 15], arrow: [7, 11]},
    imgRequire: {},
    imgLoaded: {},
    requireImage: function (e) {
        jscolor.imgRequire[e] = !0
    },
    loadImage: function (e) {
        jscolor.imgLoaded[e] || (jscolor.imgLoaded[e] = new Image, jscolor.imgLoaded[e].src = jscolor.getDir() + e)
    },
    fetchElement: function (e) {
        return "string" == typeof e ? document.getElementById(e) : e
    },
    addEvent: function (e, t, o) {
        e.addEventListener ? e.addEventListener(t, o, !1) : e.attachEvent && e.attachEvent("on" + t, o)
    },
    fireEvent: function (e, t) {
        if (e) if (document.createEvent) (o = document.createEvent("HTMLEvents")).initEvent(t, !0, !0), e.dispatchEvent(o); else if (document.createEventObject) {
            var o = document.createEventObject();
            e.fireEvent("on" + t, o)
        } else e["on" + t] && e["on" + t]()
    },
    getElementPos: function (e) {
        var t = e, o = e, n = 0, r = 0;
        if (t.offsetParent) do {
            n += t.offsetLeft, r += t.offsetTop
        } while (t = t.offsetParent);
        for (; (o = o.parentNode) && "BODY" !== o.nodeName.toUpperCase();) n -= o.scrollLeft, r -= o.scrollTop;
        return [n, r]
    },
    getElementSize: function (e) {
        return [e.offsetWidth, e.offsetHeight]
    },
    getRelMousePos: function (e) {
        var t = 0, o = 0;
        return e || (e = window.event), "number" == typeof e.offsetX ? (t = e.offsetX, o = e.offsetY) : "number" == typeof e.layerX && (t = e.layerX, o = e.layerY), {
            x: t,
            y: o
        }
    },
    getViewPos: function () {
        return "number" == typeof window.pageYOffset ? [window.pageXOffset, window.pageYOffset] : document.body && (document.body.scrollLeft || document.body.scrollTop) ? [document.body.scrollLeft, document.body.scrollTop] : document.documentElement && (document.documentElement.scrollLeft || document.documentElement.scrollTop) ? [document.documentElement.scrollLeft, document.documentElement.scrollTop] : [0, 0]
    },
    getViewSize: function () {
        return "number" == typeof window.innerWidth ? [window.innerWidth, window.innerHeight] : document.body && (document.body.clientWidth || document.body.clientHeight) ? [document.body.clientWidth, document.body.clientHeight] : document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight) ? [document.documentElement.clientWidth, document.documentElement.clientHeight] : [0, 0]
    },
    URI: function (e) {
        function t(e) {
            for (var t = ""; e;) if ("../" === e.substr(0, 3) || "./" === e.substr(0, 2)) e = e.replace(/^\.+/, "").substr(1); else if ("/./" === e.substr(0, 3) || "/." === e) e = "/" + e.substr(3); else if ("/../" === e.substr(0, 4) || "/.." === e) e = "/" + e.substr(4), t = t.replace(/\/?[^\/]*$/, ""); else if ("." === e || ".." === e) e = ""; else {
                var o = e.match(/^\/?[^\/]*/)[0];
                e = e.substr(o.length), t += o
            }
            return t
        }

        this.scheme = null, this.authority = null, this.path = "", this.query = null, this.fragment = null, this.parse = function (e) {
            var t = e.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);
            return this.scheme = t[3] ? t[2] : null, this.authority = t[5] ? t[6] : null, this.path = t[7], this.query = t[9] ? t[10] : null, this.fragment = t[12] ? t[13] : null, this
        }, this.toString = function () {
            var e = "";
            return null !== this.scheme && (e = e + this.scheme + ":"), null !== this.authority && (e = e + "//" + this.authority), null !== this.path && (e += this.path), null !== this.query && (e = e + "?" + this.query), null !== this.fragment && (e = e + "#" + this.fragment), e
        }, this.toAbsolute = function (e) {
            e = new jscolor.URI(e);
            var o = this, n = new jscolor.URI;
            return null !== e.scheme && (null !== o.scheme && o.scheme.toLowerCase() === e.scheme.toLowerCase() && (o.scheme = null), null !== o.scheme ? (n.scheme = o.scheme, n.authority = o.authority, n.path = t(o.path), n.query = o.query) : (null !== o.authority ? (n.authority = o.authority, n.path = t(o.path), n.query = o.query) : ("" === o.path ? (n.path = e.path, null !== o.query ? n.query = o.query : n.query = e.query) : ("/" === o.path.substr(0, 1) ? n.path = t(o.path) : (null !== e.authority && "" === e.path ? n.path = "/" + o.path : n.path = e.path.replace(/[^\/]+$/, "") + o.path, n.path = t(n.path)), n.query = o.query), n.authority = e.authority), n.scheme = e.scheme), n.fragment = o.fragment, n)
        }, e && this.parse(e)
    },
    color: function (target, prop) {
        for (var p in this.required = !0, this.adjust = !0, this.hash = !1, this.caps = !0, this.slider = !0, this.valueElement = target, this.styleElement = target, this.onImmediateChange = null, this.hsv = [0, 0, 1], this.rgb = [1, 1, 1], this.pickerOnfocus = !0, this.pickerMode = "HSV", this.pickerPosition = "bottom", this.pickerSmartPosition = !0, this.pickerButtonHeight = 20, this.pickerClosable = !1, this.pickerCloseText = "Close", this.pickerButtonColor = "ButtonText", this.pickerFace = 10, this.pickerFaceColor = "ThreeDFace", this.pickerBorder = 1, this.pickerBorderColor = "ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight", this.pickerInset = 1, this.pickerInsetColor = "ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow", this.pickerZIndex = 1e4, prop) prop.hasOwnProperty(p) && (this[p] = prop[p]);

        function RGB_HSV(e, t, o) {
            var n = Math.min(Math.min(e, t), o), r = Math.max(Math.max(e, t), o), i = r - n;
            if (0 === i) return [null, 0, r];
            var l = e === n ? 3 + (o - t) / i : t === n ? 5 + (e - o) / i : 1 + (t - e) / i;
            return [6 === l ? 0 : l, i / r, r]
        }

        function HSV_RGB(e, t, o) {
            if (null === e) return [o, o, o];
            var n = Math.floor(e), r = o * (1 - t), i = o * (1 - t * (n % 2 ? e - n : 1 - (e - n)));
            switch (n) {
                case 6:
                case 0:
                    return [o, i, r];
                case 1:
                    return [i, o, r];
                case 2:
                    return [r, o, i];
                case 3:
                    return [r, i, o];
                case 4:
                    return [i, r, o];
                case 5:
                    return [o, r, i]
            }
        }

        function removePicker() {
            delete jscolor.picker.owner, document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)
        }

        function drawPicker(e, t) {
            if (!jscolor.picker) {
                jscolor.picker = {
                    box: document.createElement("div"),
                    boxB: document.createElement("div"),
                    pad: document.createElement("div"),
                    padB: document.createElement("div"),
                    padM: document.createElement("div"),
                    sld: document.createElement("div"),
                    sldB: document.createElement("div"),
                    sldM: document.createElement("div"),
                    btn: document.createElement("div"),
                    btnS: document.createElement("span"),
                    btnT: document.createTextNode(THIS.pickerCloseText)
                };
                for (var o = 0; o < jscolor.images.sld[1]; o += 4) {
                    var n = document.createElement("div");
                    n.style.height = "4px", n.style.fontSize = "1px", n.style.lineHeight = "0", jscolor.picker.sld.appendChild(n)
                }
                jscolor.picker.sldB.appendChild(jscolor.picker.sld), jscolor.picker.box.appendChild(jscolor.picker.sldB), jscolor.picker.box.appendChild(jscolor.picker.sldM), jscolor.picker.padB.appendChild(jscolor.picker.pad), jscolor.picker.box.appendChild(jscolor.picker.padB), jscolor.picker.box.appendChild(jscolor.picker.padM), jscolor.picker.btnS.appendChild(jscolor.picker.btnT), jscolor.picker.btn.appendChild(jscolor.picker.btnS), jscolor.picker.box.appendChild(jscolor.picker.btn), jscolor.picker.boxB.appendChild(jscolor.picker.box)
            }
            var r = jscolor.picker;
            r.box.onmouseup = r.box.onmouseout = function () {
                target.focus()
            }, r.box.onmousedown = function () {
                abortBlur = !0
            }, r.box.onmousemove = function (e) {
                (holdPad || holdSld) && (holdPad && setPad(e), holdSld && setSld(e), document.selection ? document.selection.empty() : window.getSelection && window.getSelection().removeAllRanges(), dispatchImmediateChange())
            }, r.padM.onmouseup = r.padM.onmouseout = function () {
                holdPad && (holdPad = !1, jscolor.fireEvent(valueElement, "change"))
            }, r.padM.onmousedown = function (e) {
                holdPad = !0, setPad(e), dispatchImmediateChange()
            }, r.sldM.onmouseup = r.sldM.onmouseout = function () {
                holdSld && (holdSld = !1, jscolor.fireEvent(valueElement, "change"))
            }, r.sldM.onmousedown = function (e) {
                holdSld = !0, setSld(e), dispatchImmediateChange()
            };
            var i, l, a = getPickerDims(THIS);
            r.box.style.width = a[0] + "px", r.box.style.height = a[1] + "px", r.boxB.style.position = "absolute", r.boxB.style.clear = "both", r.boxB.style.left = e + "px", r.boxB.style.top = t + "px", r.boxB.style.zIndex = THIS.pickerZIndex, r.boxB.style.border = THIS.pickerBorder + "px solid", r.boxB.style.borderColor = THIS.pickerBorderColor, r.boxB.style.background = THIS.pickerFaceColor, r.pad.style.width = jscolor.images.pad[0] + "px", r.pad.style.height = jscolor.images.pad[1] + "px", r.padB.style.position = "absolute", r.padB.style.left = THIS.pickerFace + "px", r.padB.style.top = THIS.pickerFace + "px", r.padB.style.border = THIS.pickerInset + "px solid", r.padB.style.borderColor = THIS.pickerInsetColor, r.padM.style.position = "absolute", r.padM.style.left = "0", r.padM.style.top = "0", r.padM.style.width = THIS.pickerFace + 2 * THIS.pickerInset + jscolor.images.pad[0] + jscolor.images.arrow[0] + "px", r.padM.style.height = r.box.style.height, r.padM.style.cursor = "crosshair", r.sld.style.overflow = "hidden", r.sld.style.width = jscolor.images.sld[0] + "px", r.sld.style.height = jscolor.images.sld[1] + "px", r.sldB.style.display = THIS.slider ? "block" : "none", r.sldB.style.position = "absolute", r.sldB.style.right = THIS.pickerFace + "px", r.sldB.style.top = THIS.pickerFace + "px", r.sldB.style.border = THIS.pickerInset + "px solid", r.sldB.style.borderColor = THIS.pickerInsetColor, r.sldM.style.display = THIS.slider ? "block" : "none", r.sldM.style.position = "absolute", r.sldM.style.right = "0", r.sldM.style.top = "0", r.sldM.style.width = jscolor.images.sld[0] + jscolor.images.arrow[0] + THIS.pickerFace + 2 * THIS.pickerInset + "px", r.sldM.style.height = r.box.style.height;
            try {
                r.sldM.style.cursor = "pointer"
            } catch (e) {
                r.sldM.style.cursor = "hand"
            }
            r.btn.style.display = THIS.pickerClosable ? "block" : "none", r.btn.style.position = "absolute", r.btn.style.left = THIS.pickerFace + "px", r.btn.style.bottom = THIS.pickerFace + "px", r.btn.style.padding = "0 15px", r.btn.style.height = "18px", r.btn.style.border = THIS.pickerInset + "px solid", i = THIS.pickerInsetColor.split(/\s+/), l = i.length < 2 ? i[0] : i[1] + " " + i[0] + " " + i[0] + " " + i[1], r.btn.style.borderColor = l, r.btn.style.color = THIS.pickerButtonColor, r.btn.style.font = "12px sans-serif", r.btn.style.textAlign = "center";
            try {
                r.btn.style.cursor = "pointer"
            } catch (e) {
                r.btn.style.cursor = "hand"
            }
            switch (r.btn.onmousedown = function () {
                THIS.hidePicker()
            }, r.btnS.style.lineHeight = r.btn.style.height, modeID) {
                case 0:
                    var s = "hs.png";
                    break;
                case 1:
                    s = "hv.png"
            }
            r.padM.style.backgroundImage = "url('" + jscolor.getDir() + "cross.gif')", r.padM.style.backgroundRepeat = "no-repeat", r.sldM.style.backgroundImage = "url('" + jscolor.getDir() + "arrow.gif')", r.sldM.style.backgroundRepeat = "no-repeat", r.pad.style.backgroundImage = "url('" + jscolor.getDir() + s + "')", r.pad.style.backgroundRepeat = "no-repeat", r.pad.style.backgroundPosition = "0 0", redrawPad(), redrawSld(), jscolor.picker.owner = THIS, document.getElementsByTagName("body")[0].appendChild(r.boxB)
        }

        function getPickerDims(e) {
            return [2 * e.pickerInset + 2 * e.pickerFace + jscolor.images.pad[0] + (e.slider ? 2 * e.pickerInset + 2 * jscolor.images.arrow[0] + jscolor.images.sld[0] : 0), e.pickerClosable ? 4 * e.pickerInset + 3 * e.pickerFace + jscolor.images.pad[1] + e.pickerButtonHeight : 2 * e.pickerInset + 2 * e.pickerFace + jscolor.images.pad[1]]
        }

        function redrawPad() {
            switch (modeID) {
                case 0:
                    var e = 1;
                    break;
                case 1:
                    e = 2
            }
            var t = Math.round(THIS.hsv[0] / 6 * (jscolor.images.pad[0] - 1)),
                o = Math.round((1 - THIS.hsv[e]) * (jscolor.images.pad[1] - 1));
            jscolor.picker.padM.style.backgroundPosition = THIS.pickerFace + THIS.pickerInset + t - Math.floor(jscolor.images.cross[0] / 2) + "px " + (THIS.pickerFace + THIS.pickerInset + o - Math.floor(jscolor.images.cross[1] / 2)) + "px";
            var n = jscolor.picker.sld.childNodes;
            switch (modeID) {
                case 0:
                    for (var r = HSV_RGB(THIS.hsv[0], THIS.hsv[1], 1), i = 0; i < n.length; i += 1) n[i].style.backgroundColor = "rgb(" + r[0] * (1 - i / n.length) * 100 + "%," + r[1] * (1 - i / n.length) * 100 + "%," + r[2] * (1 - i / n.length) * 100 + "%)";
                    break;
                case 1:
                    var l, a = [THIS.hsv[2], 0, 0],
                        s = (i = Math.floor(THIS.hsv[0])) % 2 ? THIS.hsv[0] - i : 1 - (THIS.hsv[0] - i);
                    switch (i) {
                        case 6:
                        case 0:
                            r = [0, 1, 2];
                            break;
                        case 1:
                            r = [1, 0, 2];
                            break;
                        case 2:
                            r = [2, 0, 1];
                            break;
                        case 3:
                            r = [2, 1, 0];
                            break;
                        case 4:
                            r = [1, 2, 0];
                            break;
                        case 5:
                            r = [0, 2, 1]
                    }
                    for (i = 0; i < n.length; i += 1) l = 1 - 1 / (n.length - 1) * i, a[1] = a[0] * (1 - l * s), a[2] = a[0] * (1 - l), n[i].style.backgroundColor = "rgb(" + 100 * a[r[0]] + "%," + 100 * a[r[1]] + "%," + 100 * a[r[2]] + "%)"
            }
        }

        function redrawSld() {
            switch (modeID) {
                case 0:
                    var e = 2;
                    break;
                case 1:
                    e = 1
            }
            var t = Math.round((1 - THIS.hsv[e]) * (jscolor.images.sld[1] - 1));
            jscolor.picker.sldM.style.backgroundPosition = "0 " + (THIS.pickerFace + THIS.pickerInset + t - Math.floor(jscolor.images.arrow[1] / 2)) + "px"
        }

        function isPickerOwner() {
            return jscolor.picker && jscolor.picker.owner === THIS
        }

        function blurTarget() {
            valueElement === target && THIS.importColor(), THIS.pickerOnfocus && THIS.hidePicker()
        }

        function blurValue() {
            valueElement !== target && THIS.importColor()
        }

        function setPad(e) {
            var t = jscolor.getRelMousePos(e), o = t.x - THIS.pickerFace - THIS.pickerInset,
                n = t.y - THIS.pickerFace - THIS.pickerInset;
            switch (modeID) {
                case 0:
                    THIS.fromHSV(o * (6 / (jscolor.images.pad[0] - 1)), 1 - n / (jscolor.images.pad[1] - 1), null, leaveSld);
                    break;
                case 1:
                    THIS.fromHSV(o * (6 / (jscolor.images.pad[0] - 1)), null, 1 - n / (jscolor.images.pad[1] - 1), leaveSld)
            }
        }

        function setSld(e) {
            var t = jscolor.getRelMousePos(e).y - THIS.pickerFace - THIS.pickerInset;
            switch (modeID) {
                case 0:
                    THIS.fromHSV(null, null, 1 - t / (jscolor.images.sld[1] - 1), leavePad);
                    break;
                case 1:
                    THIS.fromHSV(null, 1 - t / (jscolor.images.sld[1] - 1), null, leavePad)
            }
        }

        function dispatchImmediateChange() {
            THIS.onImmediateChange && ("string" == typeof THIS.onImmediateChange ? eval(THIS.onImmediateChange) : THIS.onImmediateChange(THIS))
        }

        this.hidePicker = function () {
            isPickerOwner() && removePicker()
        }, this.showPicker = function () {
            if (!isPickerOwner()) {
                var e, t, o, n = jscolor.getElementPos(target), r = jscolor.getElementSize(target),
                    i = jscolor.getViewPos(), l = jscolor.getViewSize(), a = getPickerDims(this);
                switch (this.pickerPosition.toLowerCase()) {
                    case"left":
                        e = 1, t = 0, o = -1;
                        break;
                    case"right":
                        e = 1, t = 0, o = 1;
                        break;
                    case"top":
                        e = 0, t = 1, o = -1;
                        break;
                    default:
                        e = 0, t = 1, o = 1
                }
                var s = (r[t] + a[t]) / 2;
                if (this.pickerSmartPosition) d = [-i[e] + n[e] + a[e] > l[e] && -i[e] + n[e] + r[e] / 2 > l[e] / 2 && n[e] + r[e] - a[e] >= 0 ? n[e] + r[e] - a[e] : n[e], -i[t] + n[t] + r[t] + a[t] - s + s * o > l[t] ? -i[t] + n[t] + r[t] / 2 > l[t] / 2 && n[t] + r[t] - s - s * o >= 0 ? n[t] + r[t] - s - s * o : n[t] + r[t] - s + s * o : n[t] + r[t] - s + s * o >= 0 ? n[t] + r[t] - s + s * o : n[t] + r[t] - s - s * o]; else var d = [n[e], n[t] + r[t] - s + s * o];
                drawPicker(d[e], d[t])
            }
        }, this.importColor = function () {
            valueElement ? this.adjust ? !this.required && /^\s*$/.test(valueElement.value) ? (valueElement.value = "", styleElement.style.backgroundColor = styleElement.jscStyle.backgroundColor, styleElement.style.color = styleElement.jscStyle.color, this.exportColor(leaveValue | leaveStyle)) : this.fromString(valueElement.value) || this.exportColor() : this.fromString(valueElement.value, leaveValue) || (styleElement.style.backgroundColor = styleElement.jscStyle.backgroundColor, styleElement.style.color = styleElement.jscStyle.color, this.exportColor(leaveValue | leaveStyle)) : this.exportColor()
        }, this.exportColor = function (e) {
            if (!(e & leaveValue) && valueElement) {
                var t = this.toString();
                this.caps && (t = t.toUpperCase()), this.hash && (t = "#" + t), valueElement.value = t, BlitzMap.updateOverlay()
            }
            e & leaveStyle || !styleElement || (styleElement.style.backgroundColor = "#" + this.toString(), styleElement.style.color = .213 * this.rgb[0] + .715 * this.rgb[1] + .072 * this.rgb[2] < .5 ? "#FFF" : "#000"), e & leavePad || !isPickerOwner() || redrawPad(), e & leaveSld || !isPickerOwner() || redrawSld()
        }, this.fromHSV = function (e, t, o, n) {
            e < 0 && (e = 0) || e > 6 && (e = 6), t < 0 && (t = 0) || t > 1 && (t = 1), o < 0 && (o = 0) || o > 1 && (o = 1), this.rgb = HSV_RGB(null === e ? this.hsv[0] : this.hsv[0] = e, null === t ? this.hsv[1] : this.hsv[1] = t, null === o ? this.hsv[2] : this.hsv[2] = o), this.exportColor(n)
        }, this.fromRGB = function (e, t, o, n) {
            e < 0 && (e = 0) || e > 1 && (e = 1), t < 0 && (t = 0) || t > 1 && (t = 1), o < 0 && (o = 0) || o > 1 && (o = 1);
            var r = RGB_HSV(null === e ? this.rgb[0] : this.rgb[0] = e, null === t ? this.rgb[1] : this.rgb[1] = t, null === o ? this.rgb[2] : this.rgb[2] = o);
            null !== r[0] && (this.hsv[0] = r[0]), 0 !== r[2] && (this.hsv[1] = r[1]), this.hsv[2] = r[2], this.exportColor(n)
        }, this.fromString = function (e, t) {
            var o = e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);
            return !!o && (6 === o[1].length ? this.fromRGB(parseInt(o[1].substr(0, 2), 16) / 255, parseInt(o[1].substr(2, 2), 16) / 255, parseInt(o[1].substr(4, 2), 16) / 255, t) : this.fromRGB(parseInt(o[1].charAt(0) + o[1].charAt(0), 16) / 255, parseInt(o[1].charAt(1) + o[1].charAt(1), 16) / 255, parseInt(o[1].charAt(2) + o[1].charAt(2), 16) / 255, t), !0)
        }, this.toString = function () {
            return (256 | Math.round(255 * this.rgb[0])).toString(16).substr(1) + (256 | Math.round(255 * this.rgb[1])).toString(16).substr(1) + (256 | Math.round(255 * this.rgb[2])).toString(16).substr(1)
        };
        var THIS = this, modeID = "hvs" === this.pickerMode.toLowerCase() ? 1 : 0, abortBlur = !1,
            valueElement = jscolor.fetchElement(this.valueElement),
            styleElement = jscolor.fetchElement(this.styleElement), holdPad = !1, holdSld = !1, leaveValue = 1,
            leaveStyle = 2, leavePad = 4, leaveSld = 8;
        if (jscolor.addEvent(target, "focus", function () {
            THIS.pickerOnfocus && THIS.showPicker()
        }), jscolor.addEvent(target, "blur", function () {
            abortBlur ? abortBlur = !1 : window.setTimeout(function () {
                abortBlur || blurTarget(), abortBlur = !1
            }, 0)
        }), valueElement) {
            var updateField = function () {
                THIS.fromString(valueElement.value, leaveValue), dispatchImmediateChange()
            };
            jscolor.addEvent(valueElement, "keyup", updateField), jscolor.addEvent(valueElement, "input", updateField), jscolor.addEvent(valueElement, "blur", blurValue), valueElement.setAttribute("autocomplete", "off")
        }
        switch (styleElement && (styleElement.jscStyle = {
            backgroundColor: styleElement.style.backgroundColor,
            color: styleElement.style.color
        }), modeID) {
            case 0:
                jscolor.requireImage("hs.png");
                break;
            case 1:
                jscolor.requireImage("hv.png")
        }
        jscolor.requireImage("cross.gif"), jscolor.requireImage("arrow.gif"), this.importColor()
    }
}, JSON;

function XMLWriter(e, t) {
    e && (this.encoding = e), t && (this.version = t)
}

jscolor.install(), function () {
    XMLWriter.prototype = {
        encoding: "ISO-8859-1",
        version: "1.0",
        formatting: "indented",
        indentChar: "\t",
        indentation: 1,
        newLine: "\n",
        writeStartDocument: function (e) {
            this.close(), this.stack = [], this.standalone = e
        },
        writeEndDocument: function () {
            this.active = this.root, this.stack = []
        },
        writeDocType: function (e) {
            this.doctype = e
        },
        writeStartElement: function (e, t) {
            t && (e = t + ":" + e);
            var o = {n: e, a: {}, c: []};
            this.active ? (this.active.c.push(o), this.stack.push(this.active)) : this.root = o, this.active = o
        },
        writeEndElement: function () {
            this.active = this.stack.pop() || this.root
        },
        writeAttributeString: function (e, t) {
            this.active && (this.active.a[e] = t)
        },
        writeString: function (e) {
            this.active && this.active.c.push(e)
        },
        writeElementString: function (e, t, o) {
            this.writeStartElement(e, o), this.writeString(t), this.writeEndElement()
        },
        writeCDATA: function (e) {
            this.writeString("<![CDATA[" + e + "]]>")
        },
        writeComment: function (e) {
            this.writeString("\x3c!-- " + e + " --\x3e")
        },
        flush: function () {
            this.stack && this.stack[0] && this.writeEndDocument();
            var e = "", t = this.indentation, o = "indented" == this.formatting.toLowerCase(),
                n = '<&#63;xml version="' + this.version + '" encoding="' + this.encoding + '"';
            if (n = n.replace("&#63;", "?"), void 0 !== this.standalone && (n += ' standalone="' + !!this.standalone + '"'), n = [n += " ?>"], this.doctype && this.root && n.push("<!DOCTYPE " + this.root.n + " " + this.doctype + ">"), o) for (; t--;) e += this.indentChar;
            return this.root && function e(t, o, n, r) {
                var i, l, a = o + "<" + t.n, s = t.c.length, d = 0;
                for (i in t.a) a += " " + i + '="' + t.a[i] + '"';
                a += s ? ">" : " />";
                r.push(a);
                if (s) {
                    do {
                        if ("string" == typeof (l = t.c[d++])) {
                            if (1 == s) return r.push(r.pop() + l + "</" + t.n + ">");
                            r.push(o + n + l)
                        } else "object" == typeof l && e(l, o + n, n, r)
                    } while (d < s);
                    r.push(o + "</" + t.n + ">")
                }
            }(this.root, "", e, n), n.join(o ? this.newLine : "")
        },
        close: function () {
            this.root && function e(t) {
                var o = t.c.length;
                for (; o--;) "object" == typeof t.c[o] && e(t.c[o]);
                t.n = t.a = t.c = null
            }(this.root), this.active = this.root = this.stack = null
        },
        getDocument: window.ActiveXObject ? function () {
            var e = new ActiveXObject("Microsoft.XMLDOM");
            return e.async = !1, e.loadXML(this.flush()), e
        } : function () {
            return (new DOMParser).parseFromString(this.flush(), "text/xml")
        }
    }
}(), JSON || (JSON = {}), function () {
    "use strict";

    function f(e) {
        return e < 10 ? "0" + e : e
    }

    "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function (e) {
        return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null
    }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function (e) {
        return this.valueOf()
    });
    var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        gap, indent, meta = {"\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\"},
        rep;

    function quote(e) {
        return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) {
            var t = meta[e];
            return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
        }) + '"' : '"' + e + '"'
    }

    function str(e, t) {
        var o, n, r, i, l, a = gap, s = t[e];
        switch (s && "object" == typeof s && "function" == typeof s.toJSON && (s = s.toJSON(e)), "function" == typeof rep && (s = rep.call(t, e, s)), typeof s) {
            case"string":
                return quote(s);
            case"number":
                return isFinite(s) ? String(s) : "null";
            case"boolean":
            case"null":
                return String(s);
            case"object":
                if (!s) return "null";
                if (gap += indent, l = [], "[object Array]" === Object.prototype.toString.apply(s)) {
                    for (i = s.length, o = 0; o < i; o += 1) l[o] = str(o, s) || "null";
                    return r = 0 === l.length ? "[]" : gap ? "[\n" + gap + l.join(",\n" + gap) + "\n" + a + "]" : "[" + l.join(",") + "]", gap = a, r
                }
                if (rep && "object" == typeof rep) for (i = rep.length, o = 0; o < i; o += 1) "string" == typeof rep[o] && (r = str(n = rep[o], s)) && l.push(quote(n) + (gap ? ": " : ":") + r); else for (n in s) Object.prototype.hasOwnProperty.call(s, n) && (r = str(n, s)) && l.push(quote(n) + (gap ? ": " : ":") + r);
                return r = 0 === l.length ? "{}" : gap ? "{\n" + gap + l.join(",\n" + gap) + "\n" + a + "}" : "{" + l.join(",") + "}", gap = a, r
        }
    }

    "function" != typeof JSON.stringify && (JSON.stringify = function (e, t, o) {
        var n;
        if (gap = "", indent = "", "number" == typeof o) for (n = 0; n < o; n += 1) indent += " "; else "string" == typeof o && (indent = o);
        if (rep = t, t && "function" != typeof t && ("object" != typeof t || "number" != typeof t.length)) throw new Error("JSON.stringify");
        return str("", {"": e})
    }), "function" != typeof JSON.parse && (JSON.parse = function (text, reviver) {
        var j;

        function walk(e, t) {
            var o, n, r = e[t];
            if (r && "object" == typeof r) for (o in r) Object.prototype.hasOwnProperty.call(r, o) && (void 0 !== (n = walk(r, o)) ? r[o] = n : delete r[o]);
            return reviver.call(e, t, r)
        }

        if (text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) {
            return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
        })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({"": j}, "") : j;
        throw new SyntaxError("JSON.parse")
    })
}();
var BlitzMap = new function () {
    var e, t, o, n, r, i, l, a, s, d, c, p = new Array, u = !1, g = !0, h = !1, m = !1, y = !1, f = !1, v = null;

    function w(e) {
        var t = x();
        e.overlay.uniqueid = t, e.overlay.title = "", e.overlay.content = "", e.overlay.type = e.type, p.push(e.overlay), b(e.overlay), k(e.overlay, function (e) {
            if ("marker" == e.type) return e.position;
            if ("circle" == e.type) return e.getCenter();
            if ("rectangle" == e.type) return new google.maps.LatLng((e.getBounds().getSouthWest().lat() + e.getBounds().getNorthEast().lat()) / 2, (e.getBounds().getSouthWest().lng() + e.getBounds().getNorthEast().lng()) / 2);
            if ("polygon" == e.type) return e.getPaths().getAt(0).getAt(0);
            if ("polyline" == e.type) return e.getPath().getAt(Math.round(e.getPath().getLength() / 3))
        }(e.overlay), I(e.overlay))
    }

    function b(e) {
        google.maps.event.addListener(e, "click", function (t) {
            if (u) var o = I(e); else o = function (e) {
                return "<div><h3>" + e.title + "</h3>" + e.content + '<br></div><div id="' + n + '_dirContainer" style="bottom:0;padding-top:3px; font-size:13px;font-family:arial"><div  style="border-top:1px dotted #999;"><style>.BlitzMap_Menu:hover{text-decoration:underline; }</style><span class="BlitzMap_Menu" style="color:#ff0000; cursor:pointer;padding:0 5px;" onclick="BlitzMap.getDirections()">Directions</span><span class="BlitzMap_Menu" style="color:#ff0000; cursor:pointer;padding:0 5px;">Search nearby</span><span class="BlitzMap_Menu" style="color:#ff0000; cursor:pointer;padding:0 5px;">Save to map</span></div></div>'
            }(e);
            k(e, t.latLng, o)
        })
    }

    function k(t, n, r) {
        var i = document.createElement("div");
        i.innerHTML = r, B(i, {height: "100%"}), o.setContent(i), o.setPosition(n), o.relatedOverlay = t;
        t.get("fillColor");
        o.open(e)
    }

    function I(e) {
        var t = '<style>#BlitzMapInfoWindow_container input:focus, #BlitzMapInfoWindow_container textarea:focus{border:2px solid #7DB1FF;} #BlitzMapInfoWindow_container .BlitzMapInfoWindow_button{background-color:#2883CE;color:#ffffff;padding:3px 10px;border:2px double #cccccc;cursor:pointer;} .BlitzMapInfoWindow_button:hover{background-color:#2883CE;border-color:#05439F;} </style><form style="height:100%"><div id="BlitzMapInfoWindow_container" style="height:100%"><div id="BlitzMapInfoWindow_details"><div style="padding-bottom:3px;">Title:&nbsp;&nbsp;<input type="text" id="BlitzMapInfoWindow_title" value="' + e.title + '" style="border:2px solid #dddddd;width:150px;padding:3px;" ></div><div style="padding-bottom:3px;">Description:<br><textarea id="BlitzMapInfoWindow_content" style="border:2px solid #dddddd;width:250px;height:115px;">' + e.content + '</textarea></div></div><div id="BlitzMapInfoWindow_styles" style="display:none;width:100%;"><div style="height:25px;padding-bottom:2px;font-weight:bold;">Styles &amp; Colors</div>';
        "polygon" != e.type && "circle" != e.type && "rectangle" != e.type || (t += '<div style="height:25px;padding-bottom:3px;">Fill Color: <input type="text" id="BlitzMapInfoWindow_fillcolor" value="' + (null == e.fillColor ? "#000000" : e.fillColor) + '" style="border:2px solid #dddddd;width:30px;height:20px;font-size:0;float:right" ></div>', t += '<div style="height:25px;padding-bottom:3px;">Fill Opacity(percent): <input type="text" id="BlitzMapInfoWindow_fillopacity" value="' + (null == e.fillOpacity ? .3 : e.fillOpacity).toString() + '"  style="border:2px solid #dddddd;width:30px;float:right" onkeyup="BlitzMap.updateOverlay()" ></div>');
        "marker" != e.type ? (t += '<div style="height:25px;padding-bottom:3px;">'+$managerTitlesProcess.popupManagerGoogleMaps.colors.lineColor+'<input type="text" id="BlitzMapInfoWindow_strokecolor" value="' + (null == e.strokeColor ? "#000000" : e.strokeColor) + '" style="border:2px solid #dddddd;width:30px;height:20px;font-size:0;float:right" ></div>', t += '<div style="height:25px;padding-bottom:3px;">Line Opacity(percent): <input type="text" id="BlitzMapInfoWindow_strokeopacity" value="' + (null == e.strokeOpacity ? .9 : e.strokeOpacity).toString() + '" style="border:2px solid #dddddd;width:30px;float:right" onkeyup="BlitzMap.updateOverlay()" ></div>', t += '<div style="height:25px;padding-bottom:3px;">Line Thickness(pixels): <input type="text" id="BlitzMapInfoWindow_strokeweight" value="' + (null == e.strokeWeight ? 3 : e.strokeWeight).toString() + '" style="border:2px solid #dddddd;width:30px;float:right" onkeyup="BlitzMap.updateOverlay()" ></div>') : t += '<div style="height:25px;padding-bottom:3px;">Icon(): <input type="text" id="BlitzMapInfoWindow_icon" value="' + (null == e.icon ? "" : e.icon).toString() + '" style="border:2px solid #dddddd;width:100px;float:right" ></div>';
        return t += '</div><div style="position:relative; bottom:0px;"><input type="button" value="Delete" class="BlitzMapInfoWindow_button" onclick="BlitzMap.deleteOverlay()" style="background-color:#2883CE;color:#ffffff;padding:3px 10px;border:2px double #cccccc;cursor:pointer;" title"Delete selected shape">&nbsp;&nbsp;<input type="button" value="OK" class="BlitzMapInfoWindow_button" onclick="BlitzMap.closeInfoWindow()" style="background-color:#2883CE;color:#ffffff;padding:3px 10px;border:2px double #cccccc;cursor:pointer;float:right;" title="Apply changes to the overlay"><input type="button" value="Cancel" class="BlitzMapInfoWindow_button" onclick="this.form.reset();BlitzMap.closeInfoWindow()" style="background-color:#2883CE;color:#ffffff;padding:3px 10px;border:2px double #cccccc;cursor:pointer;float:right;"><div style="clear:both;"></div><input type="button" id="BlitzMapInfoWindow_toggle" title="Manage Colors and Styles" onclick="BlitzMap.toggleStyleEditor();return false;" style="border:0;float:right;margin-top:5px;cursor:pointer;background-color:#fff;color:#2883CE;font-family:Arial;font-size:12px;text-align:right;" value="Customize Colors&gt;&gt;" />'
    }

    function E() {
        if (document.getElementById("BlitzMapInfoWindow_fillcolor")) new jscolor.color(document.getElementById("BlitzMapInfoWindow_fillcolor"), {});
        if (document.getElementById("BlitzMapInfoWindow_strokecolor")) new jscolor.color(document.getElementById("BlitzMapInfoWindow_strokecolor"), {})
    }

    function S(e) {
        g && alert(e)
    }

    function x() {
        return (new Date).getTime()
    }

    function M() {
        var t, o, n = new Object;
        n.zoom = e.getZoom(), n.tilt = e.getTilt(), n.mapTypeId = e.getMapTypeId(), n.center = {
            lat: e.getCenter().lat(),
            lng: e.getCenter().lng()
        }, n.overlays = new Array;
        for (var r = 0; r < p.length; r++) if (null != p[r].getMap()) {
            if ((t = new Object).type = p[r].type, t.title = p[r].title, t.content = p[r].content, p[r].fillColor && (t.fillColor = p[r].fillColor), p[r].fillOpacity && (t.fillOpacity = p[r].fillOpacity), p[r].strokeColor && (t.strokeColor = p[r].strokeColor), p[r].strokeOpacity && (t.strokeOpacity = p[r].strokeOpacity), p[r].strokeWeight && (t.strokeWeight = p[r].strokeWeight), p[r].icon && (t.icon = p[r].icon), p[r].flat && (t.flat = p[r].flat), "polygon" == p[r].type) {
                t.paths = new Array, o = p[r].getPaths();
                for (var i = 0; i < o.length; i++) {
                    t.paths[i] = new Array;
                    for (var l = 0; l < o.getAt(i).length; l++) t.paths[i][l] = {
                        lat: o.getAt(i).getAt(l).lat().toString(),
                        lng: o.getAt(i).getAt(l).lng().toString()
                    }
                }
            } else if ("polyline" == p[r].type) {
                t.path = new Array, path = p[r].getPath();
                for (i = 0; i < path.length; i++) t.path[i] = {
                    lat: path.getAt(i).lat().toString(),
                    lng: path.getAt(i).lng().toString()
                }
            } else "circle" == p[r].type ? (t.center = {
                lat: p[r].getCenter().lat(),
                lng: p[r].getCenter().lng()
            }, t.radius = p[r].radius) : "rectangle" == p[r].type ? t.bounds = {
                sw: {
                    lat: p[r].getBounds().getSouthWest().lat(),
                    lng: p[r].getBounds().getSouthWest().lng()
                }, ne: {lat: p[r].getBounds().getNorthEast().lat(), lng: p[r].getBounds().getNorthEast().lng()}
            } : "marker" == p[r].type && (t.position = {lat: p[r].getPosition().lat(), lng: p[r].getPosition().lng()});
            n.overlays.push(t)
        }
        return n
    }

    function _(e, t) {
        if (document.defaultView && document.defaultView.getComputedStyle) return document.defaultView.getComputedStyle(e, null).getPropertyValue(t);
        if (e.currentStyle) {
            for (var o = t.match(/\w[^-]*/g), n = o[0], r = 1; r < o.length; ++r) n += o[r].replace(/\w/, o[r].charAt(0).toUpperCase());
            return e.currentStyle[n]
        }
        return 0
    }

    function B(e, t) {
        if ("object" == typeof t) for (var o in t) e.style[o] = t[o]
    }

    this.init = function () {
        var r = {
            center: new google.maps.LatLng(19.006295, 73.309021),
            zoom: 4,
            mapTypeId: google.maps.MapTypeId.HYBRID
        };
        o = new google.maps.InfoWindow, u && (t = new google.maps.drawing.DrawingManager({
            drawingControl: !0,
            drawingControlOptions: {
                position: google.maps.ControlPosition.TOP_CENTER,
                drawingModes: [google.maps.drawing.OverlayType.MARKER, google.maps.drawing.OverlayType.CIRCLE, google.maps.drawing.OverlayType.RECTANGLE, google.maps.drawing.OverlayType.POLYGON, google.maps.drawing.OverlayType.POLYLINE]
            },
            markerOptions: {editable: !0, draggable: !0},
            circleOptions: {editable: !0},
            rectangleOptions: {editable: !0},
            polygonOptions: {editable: !0},
            polylineOptions: {editable: !0}
        })), i && (e = new google.maps.Map(i, r), o.setMap(e), u && (t.setMap(e), google.maps.event.addListener(o, "domready", E), google.maps.event.addListener(t, "overlaycomplete", w)), l && function (t) {
            if (0 == t.length) return !1;
            var o, n, r = JSON.parse(t);
            r.zoom ? e.setZoom(r.zoom) : e.setZoom(10);
            r.tilt ? e.setTilt(r.tilt) : e.setTilt(0);
            r.mapTypeId ? e.setMapTypeId(r.mapTypeId) : e.setMapTypeId("hybrid");
            r.center ? e.setCenter(new google.maps.LatLng(r.center.lat, r.center.lng)) : e.setCenter(new google.maps.LatLng(19.006295, 73.309021));
            for (var i = new Array("fillColor", "fillOpacity", "strokeColor", "strokeOpacity", "strokeWeight", "icon"), l = r.overlays.length - 1; l >= 0; l--) {
                n = new Object;
                for (var a = i.length; a >= 0; a--) r.overlays[l][i[a]] && (n[i[a]] = r.overlays[l][i[a]]);
                if ("polygon" == r.overlays[l].type) {
                    for (var s = new Array, d = 0; d < r.overlays[l].paths.length; d++) {
                        for (var c = new Array, g = 0; g < r.overlays[l].paths[d].length; g++) c.push(new google.maps.LatLng(r.overlays[l].paths[d][g].lat, r.overlays[l].paths[d][g].lng));
                        s.push(c)
                    }
                    n.paths = s, o = new google.maps.Polygon(n)
                } else if ("polyline" == r.overlays[l].type) {
                    for (var c = new Array, g = 0; g < r.overlays[l].path.length; g++) c.push(new google.maps.LatLng(r.overlays[l].path[g].lat, r.overlays[l].path[g].lng));
                    n.path = c, o = new google.maps.Polyline(n)
                } else if ("rectangle" == r.overlays[l].type) {
                    var h = new google.maps.LatLngBounds(new google.maps.LatLng(r.overlays[l].bounds.sw.lat, r.overlays[l].bounds.sw.lng), new google.maps.LatLng(r.overlays[l].bounds.ne.lat, r.overlays[l].bounds.ne.lng));
                    n.bounds = h, o = new google.maps.Rectangle(n)
                } else if ("circle" == r.overlays[l].type) {
                    var m = new google.maps.LatLng(r.overlays[l].center.lat, r.overlays[l].center.lng);
                    n.center = m, n.radius = r.overlays[l].radius, o = new google.maps.Circle(n)
                } else if ("marker" == r.overlays[l].type) {
                    var y = new google.maps.LatLng(r.overlays[l].position.lat, r.overlays[l].position.lng);
                    n.position = y, r.overlays[l].icon && (n.icon = r.overlays[l].icon), u && (n.draggable = !0), o = new google.maps.Marker(n)
                }
                o.type = r.overlays[l].type, o.setMap(e), u && "marker" != r.overlays[l].type && o.setEditable(!0);
                var f = x();
                o.uniqueid = f, r.overlays[l].title ? o.title = r.overlays[l].title : o.title = "", r.overlays[l].content ? o.content = r.overlays[l].content : o.content = "", b(o), p.push(o)
            }
        }(document.getElementById(l).value), (a = new google.maps.DirectionsRenderer).setMap(e), a.setPanel(document.getElementById(n + "_directions")), s = new google.maps.DirectionsService, d = google.maps.TravelMode.DRIVING, h = !1, m = !1, y = !0, c = google.maps.UnitSystem.METRIC, f = !0)
    }, this.setMap = function (e, t, o) {
        "string" == typeof e ? document.getElementById(e) ? (n = e, (i = document.createElement("div")).id = e + "_map", B(i, {
            height: "100%",
            width: "100%",
            position: "absolute",
            zIndex: 1,
            left: "0"
        }), document.getElementById(n).appendChild(i), (r = document.createElement("div")).id = e + "_sidebar", B(r, {
            height: "100%",
            width: "250px",
            display: "none",
            backgroundColor: "#e6e6e6",
            borderLeft: "5px solid #999",
            position: "absolute",
            zIndex: "1",
            right: "0",
            fontFamily: "Arial",
            overflowY: "auto"
        }), document.getElementById(n).appendChild(r), B(document.getElementById(n), {position: "relative"}), r.innerHTML = '<div style="padding:10px 0 0 26px;"><style> div#' + r.id + " a.travelMode{ height:37px;width:32px;display:block;float:left;margin:0; background-position:bottom;background-repeat:no-repeat;outline:0;} div#" + r.id + " a.travelMode:hover{ cursor:pointer; background-position:top;} div#" + r.id + " span.route_row_menu{ font-size:12px;font-family:Arial; color:#ff0000; cursor:pointer; }  div#" + n + "_route div.route_row span{ width:20px;height:20px;display:inline-block; text-align:center; }  div#" + n + "_route_options{ font-size:12px; }  div#" + n + '_directions{ font-size:12px; }</style><a id="' + n + '_mode_drive" href="javascript:void(0)" class="travelMode" style="background-image:url(images/car.png);background-position:top;" onclick="BlitzMap.setTravelMode( google.maps.TravelMode.DRIVING, this )" ></a><a id="' + n + '_mode_walk" href="javascript:void(0)" class="travelMode" style="background-image:url(images/walk.png);" onclick="BlitzMap.setTravelMode( google.maps.TravelMode.WALKING, this)"></a><a id="' + n + '_mode_bicycle" href="javascript:void(0)" class="travelMode" style="background-image:url(images/bicycle.png);" onclick="BlitzMap.setTravelMode( google.maps.TravelMode.BICYCLING, this )"></a><div style="clear:both;"></div></div><div id="' + n + '_route" style="margin:5px 5px 5px;"><div id="' + n + '_route_row_0" class="route_row"><span id="' + n + '_route_row_0_title">A</span> <input  id="' + n + '_route_row_0_dest" type="text" /><img id="' + n + '_route_row_0_remove" alt="X" height="20" width="20" onclick="BlitzMap.removeDestination(this)" style="cursor:pointer;display:none;" /></div><div id="' + n + '_route_row_1" class="route_row"><span id="' + n + '_route_row_1_title">B</span> <input  id="' + n + '_route_row_1_dest" type="text" /><img id="' + n + '_route_row_1_remove" alt="X" height="20" width="20" onclick="BlitzMap.removeDestination(this)" style="cursor:pointer;display:none;" /></div></div><div id="' + n + '_route_menu" style="margin:5px 5px 5px 30px;"><span class="route_row_menu" onclick="BlitzMap.addDestination()">Add destination</span> - <span id="' + n + '_route_opt_btn" class="route_row_menu" onclick="BlitzMap.toggleRouteOptions()">Show Options</span></div><div id="' + n + '_route_options" style="margin:5px 5px;display:none;"><div style="float:right"><span id="' + n + '_route_unit_km" onclick="BlitzMap.setRouteUnit( google.maps.UnitSystem.METRIC )">Km</span> / <span id="' + n + '_route_unit_mi" class="route_row_menu"  onclick="BlitzMap.setRouteUnit( google.maps.UnitSystem.IMPERIAL )">Miles</span></div><div style="margin-left:20px"><input id="' + n + '_route_avoid_hw" type="checkbox" value="avoidHighways" onclick="BlitzMap.setAvoidHighways(this)" /><label for="' + n + '_route_avoid_hw">Avoid highways</label><br/><input id="' + n + '_route_avoid_toll" type="checkbox" value="avoidTolls" onclick="BlitzMap.setAvoidTolls(this)" /><label for="' + n + '_route_avoid_toll">Avoid tolls</label> </div></div><div style="margin:0 0 10px 30px"><input type="button" onclick="BlitzMap.getRoute()" value="Get Directions"></div><div style="clear:both;"></div><div id="' + n + '_directions" style=""></div>') : S("BlitzMap Error: The DIV id you supplied for generating GMap is not present in the document.") : S("BlitzMap Error: The DIV id you supplied for generating GMap is invalid. It should be a string representing the Id of Div element in which you want to create the map."), 1 == t && (u = !0), "string" == typeof o && (document.getElementById(o) ? l = o : S("BlitzMap Error: The INPUT id you supplied for storing the JSON string is not present in the document."))
    }, this.setAvoidHighways = function (e) {
        h = e.checked
    }, this.setAvoidTolls = function (e) {
        m = e.checked
    }, this.setTravelMode = function (e, t) {
        d = e, B(document.getElementById(n + "_mode_drive"), {backgroundPosition: "bottom"}), B(document.getElementById(n + "_mode_walk"), {backgroundPosition: "bottom"}), B(document.getElementById(n + "_mode_bicycle"), {backgroundPosition: "bottom"}), B(t, {backgroundPosition: "top"})
    }, this.getRoute = function () {
        for (var e, t, o = [], r = document.getElementById(n + "_route"), i = 0; i < r.children.length; i++) 0 == i ? e = r.children[i].children[1].value : i == r.children.length - 1 ? t = r.children[i].children[1].value : o.push({
            location: r.children[i].children[1].value,
            stopover: !0
        });
        var l = {
            origin: e,
            destination: t,
            waypoints: o,
            optimizeWaypoints: !1,
            travelMode: d,
            avoidHighways: h,
            avoidTolls: m,
            provideRouteAlternatives: y,
            unitSystem: c,
            optimizeWaypoints: f
        };
        s.route(l, function (e, t) {
            t == google.maps.DirectionsStatus.OK && a.setDirections(e)
        })
    }, this.addDestination = function () {
        var e = document.getElementById(n + "_route"), t = e.children.length;
        if (8 != t) {
            var o = document.createElement("div");
            o.id = n + "_route_row_" + t.toString(), o.className = "route_row", o.innerHTML = '<span id="' + n + "_route_row_" + t + '_title">' + String.fromCharCode(65 + t) + '</span> <input id="' + n + "_route_row_" + t + '_dest" type="text" /><img id="' + n + "_route_row_" + t + '_remove" alt="X" height="20" width="20" onclick="BlitzMap.removeDestination(this)" style="cursor:pointer" />', e.appendChild(o);
            for (var r = 0; r < e.children.length; r++) r < 2 && e.children.length <= 2 ? e.children[r].children[2].style.display = "none" : e.children[r].children[2].style.display = "inline"
        } else alert("You have reached maximum number of destinations that can be searched with Google Directions API.")
    }, this.removeDestination = function (e) {
        var t = e.parentNode, o = t.parentNode;
        o.removeChild(t);
        for (var r = 0; r < o.children.length; r++) o.children[r].id = n + "_route_row_" + r, o.children[r].children[0].id = n + "_route_row_" + r + "_title", o.children[r].children[0].innerHTML = String.fromCharCode(65 + r), o.children[r].children[1].id = n + "_route_row_" + r + "_dest", o.children[r].children[2].id = n + "_route_row_" + r + "_remove", r < 2 && o.children.length <= 2 ? o.children[r].children[2].style.display = "none" : o.children[r].children[2].style.display = "inline"
    }, this.setRouteUnit = function (e) {
        (c = e) == google.maps.UnitSystem.IMPERIAL ? (document.getElementById(n + "_route_unit_mi").className = "", document.getElementById(n + "_route_unit_km").className = "route_row_menu") : (document.getElementById(n + "_route_unit_mi").className = "route_row_menu", document.getElementById(n + "_route_unit_km").className = "")
    }, this.toggleRouteOptions = function () {
        "block" == _(document.getElementById(n + "_route_options"), "display") ? (B(document.getElementById(n + "_route_options"), {display: "none"}), document.getElementById(n + "_route_opt_btn").innerHTML = "Show Options") : (B(document.getElementById(n + "_route_options"), {display: "block"}), document.getElementById(n + "_route_opt_btn").innerHTML = "Hide Options")
    }, this.getDirections = function () {
        B(r, {display: "block"}), B(i, {width: "70%"}), google.maps.event.trigger(e, "resize")
    }, this.deleteOverlay = function () {
        o.relatedOverlay.setMap(null), o.close()
    }, this.closeInfoWindow = function () {
        this.updateOverlay(), o.close()
    }, this.updateOverlay = function () {
        o.relatedOverlay.title = document.getElementById("BlitzMapInfoWindow_title").value, o.relatedOverlay.content = document.getElementById("BlitzMapInfoWindow_content").value, "polygon" != o.relatedOverlay.type && "circle" != o.relatedOverlay.type && "rectangle" != o.relatedOverlay.type || (o.relatedOverlay.setOptions({fillColor: "#" + document.getElementById("BlitzMapInfoWindow_fillcolor").value.replace("#", "")}), B(document.getElementById("BlitzMapInfoWindow_fillcolor"), {"background-color": "#" + document.getElementById("BlitzMapInfoWindow_fillcolor").value.replace("#", "")}), o.relatedOverlay.setOptions({fillOpacity: Number(document.getElementById("BlitzMapInfoWindow_fillopacity").value)})), "marker" != o.relatedOverlay.type ? (o.relatedOverlay.setOptions({strokeColor: "#" + document.getElementById("BlitzMapInfoWindow_strokecolor").value.replace("#", "")}), o.relatedOverlay.setOptions({strokeOpacity: Number(document.getElementById("BlitzMapInfoWindow_strokeopacity").value)}), o.relatedOverlay.setOptions({strokeWeight: Number(document.getElementById("BlitzMapInfoWindow_strokeweight").value)})) : o.relatedOverlay.setOptions({icon: document.getElementById("BlitzMapInfoWindow_icon").value})
    }, this.toggleStyleEditor = function () {
        var e = document.getElementById("BlitzMapInfoWindow_details"),
            t = document.getElementById("BlitzMapInfoWindow_styles");
        e && ("none" == _(e, "display") ? (B(t, {display: "none"}), document.getElementById("BlitzMapInfoWindow_toggle").value = "Customize Colors>>", B(e, {display: "block"})) : (B(e, {display: "none"}), document.getElementById("BlitzMapInfoWindow_toggle").value = "Back>>", B(t, {display: "block"})))
    }, this.setEditable = function (e) {
        u = e;
        for (var t = 0; t < p.length; t++) null != p[t].getMap() && p[t].setOptions({editable: u})
    }, this.toggleEditable = function () {
        u = !u;
        for (var e = 0; e < p.length; e++) null != p[e].getMap() && p[e].setEditable && p[e].setEditable(u)
    }, this.setMapFromEncoded = function (t) {
        if (0 == t.length) return !1;
        for (var o, n = google.maps.geometry.encoding.decodePath(t), r = new google.maps.LatLngBounds, i = 0; i < n.length; i++) r.extend(n[i]);
        var l = new Object;
        new Array("fillColor", "fillOpacity", "strokeColor", "strokeOpacity", "strokeWeight", "icon");
        l.strokeWidth = 2, l.strokeColor = "#0000FF", l.strokeOpacity = .8, l.fillColor = "#0000FF", l.fillOpacity = .2, l.paths = [n], (o = new google.maps.Polygon(l)).type = "polygon", o.setMap(e), e.fitBounds(r), o.setEditable(!0);
        var a = x();
        o.uniqueid = a, o.title = "", o.content = "", b(o), p.push(o)
    }, this.setMapFromKML = function (t) {
        if (0 == t.length) return !1;
        if ("undefined" != typeof geoXML3) {
            var o;
            v || (v = new geoXML3.parser({map: e, zoom: !1, suppressInfoWindows: !0})), v.parseKmlString(t);
            for (var n = 0; n < v.docs[0].placemarks.length; n++) {
                v.docs[0].placemarks[n].Polygon ? (o = v.docs[0].placemarks[n].polygon, u && o.setEditable(!0), o.type = "polygon") : v.docs[0].placemarks[n].LineString ? (o = v.docs[0].placemarks[n].polyline, u && o.setEditable(!0), o.type = "polyline") : v.docs[0].placemarks[n].Point && ((o = v.docs[0].placemarks[n].marker).type = "marker");
                var r = x();
                o.uniqueid = r, v.docs[0].placemarks[n].name ? o.title = v.docs[0].placemarks[n].name : o.title = "", v.docs[0].placemarks[n].description ? o.content = v.docs[0].placemarks[n].description : o.content = "", b(o), p.push(o)
            }
            e.fitBounds(v.docs[0].bounds)
        } else alert("geoxml3.js not included")
    }, this.deleteAll = function () {
        for (var e = 0; e < p.length; e++) p[e].setMap(null);
        p = []
    }, this.toJSONString = function () {
        var e = JSON.stringify(M());
        return l && (document.getElementById(l).value = e), e
    }, this.toKML = function () {
        var e = M(), t = new XMLWriter("UTF-8");
        t.formatting = "indented", t.indentChar = " ", t.indentation = 2, t.writeStartDocument(), t.writeStartElement("kml"), t.writeAttributeString("xmlns", "http://www.opengis.net/kml/2.2"), t.writeStartElement("Document");
        for (var o = 0; o < e.overlays.length; o++) {
            if (t.writeStartElement("Placemark"), t.writeStartElement("name"), t.writeCDATA(e.overlays[o].title), t.writeEndElement(), t.writeStartElement("description"), t.writeCDATA(e.overlays[o].content), t.writeEndElement(), "marker" == e.overlays[o].type) t.writeStartElement("Point"), t.writeElementString("extrude", "1"), t.writeElementString("altitudeMode", "relativeToGround"), t.writeElementString("coordinates", e.overlays[o].position.lng.toString() + "," + e.overlays[o].position.lat.toString() + ",0"), t.writeEndElement(); else if ("polygon" == e.overlays[o].type || "rectangle" == e.overlays[o].type || "circle" == e.overlays[o].type) {
                if (t.writeStartElement("Polygon"), t.writeElementString("extrude", "1"), t.writeElementString("altitudeMode", "relativeToGround"), "rectangle" == e.overlays[o].type && (t.writeStartElement("outerBoundaryIs"), t.writeStartElement("LinearRing"), t.writeStartElement("coordinates"), t.writeString(e.overlays[o].bounds.sw.lng + "," + e.overlays[o].bounds.sw.lat + ",0"), t.writeString(e.overlays[o].bounds.ne.lng + "," + e.overlays[o].bounds.sw.lat + ",0"), t.writeString(e.overlays[o].bounds.ne.lng + "," + e.overlays[o].bounds.ne.lat + ",0"), t.writeString(e.overlays[o].bounds.sw.lng + "," + e.overlays[o].bounds.ne.lat + ",0"), t.writeEndElement(), t.writeEndElement(), t.writeEndElement()), "circle" == e.overlays[o].type) {
                    t.writeStartElement("outerBoundaryIs"), t.writeStartElement("LinearRing"), t.writeStartElement("coordinates");
                    for (var n = Math.PI / 180, r = 180 / Math.PI, i = e.overlays[o].radius / 6378137 * r, l = i / Math.cos(e.overlays[o].center.lat * n), a = (new Array, 65), s = 0; s < a; s += 1) {
                        var d = Math.PI * (s / 32);
                        ey = e.overlays[o].center.lng + l * Math.cos(d), ex = e.overlays[o].center.lat + i * Math.sin(d), t.writeString(ey + "," + ex + ",0")
                    }
                    t.writeEndElement(), t.writeEndElement(), t.writeEndElement()
                } else for (s = 0; s < e.overlays[o].paths.length; s++) {
                    0 == s ? t.writeStartElement("outerBoundaryIs") : t.writeStartElement("innerBoundaryIs"), t.writeStartElement("LinearRing"), t.writeStartElement("coordinates");
                    for (var c = 0; c < e.overlays[o].paths[s].length; c++) t.writeString(e.overlays[o].paths[s][c].lng + "," + e.overlays[o].paths[s][c].lat + ",0");
                    t.writeEndElement(), t.writeEndElement(), t.writeEndElement()
                }
                t.writeEndElement()
            } else if ("polyline" == e.overlays[o].type) {
                t.writeStartElement("LineString"), t.writeElementString("extrude", "1"), t.writeElementString("altitudeMode", "relativeToGround"), t.writeStartElement("coordinates");
                for (s = 0; s < e.overlays[o].path.length; s++) t.writeString(e.overlays[o].path[s].lng + "," + e.overlays[o].path[s].lat + ",0");
                t.writeEndElement(), t.writeEndElement()
            }
            t.writeEndElement()
        }
        t.writeEndElement(), t.writeEndElement(), t.writeEndDocument();
        var p = t.flush();
        t.close(), t = void 0, document.getElementById("kmlString").value = p
    }
};
google.maps.event.addDomListener(window, "load", BlitzMap.init);
